#!/bin/bash

regions=("6000001-7000000" "7000001-8000000" "8000001-9000000" "9000001-10000000" "10000001-11000000" "11000001-12000000" "12000001-13000000" "13000001-14000000" "14000001-15000000" "15000001-16000000" "16000001-17000000" "17000001-18000000" "18000001-19000000" "19000001-20000000" "20000001-21000000" "21000001-22000000" "22000001-23000000" "23000001-24000000" "25000001-26000000" "26000001-27000000" "27000001-28000000" "28000001-29000000" "29000001-30000000" "30000001-31000000" "31000001-32000000" "32000001-33000000" "33000001-34000000" "34000001-35000000" "35000001-36000000" "36000001-37000000" "37000001-38000000" "38000001-39000000" "39000001-40000000" "40000001-41000000" "41000001-42000000" "42000001-43000000" "43000001-44000000" "44000001-45000000" "45000001-46000000" "46000001-47000000" "47000001-48000000" "48000001-49000000" "49000001-50000000" "50000001-51000000" "51000001-52000000" "52000001-53000000" "53000001-54000000" "54000001-55000000" "55000001-56000000" "56000001-57000000" "57000001-58000000" "58000001-59000000" "59000001-60000000" "60000001-61000000" "61000001-62000000" "62000001-63000000" "63000001-64000000" "64000001-65000000" "65000001-66000000" "66000001-67000000" "67000001-68000000" "68000001-69000000" "69000001-70000000" "70000001-71000000" "71000001-72000000" "72000001-73000000" "73000001-74000000" "74000001-75000000" "75000001-76000000" "76000001-77000000" "77000001-78000000" "78000001-79000000" "79000001-80000000" "80000001-81000000" "81000001-82000000" "82000001-83000000" "83000001-84000000" "84000001-85000000" "85000001-86000000" "86000001-87000000" "87000001-88000000" "88000001-89000000" "89000001-90000000" "90000001-91000000" "91000001-92000000" "92000001-93000000" "93000001-94000000" "94000001-95000000" "95000001-96000000" "96000001-97000000" "97000001-98000000" "98000001-99000000" "99000001-100000000" "100000001-101000000" "101000001-102000000" "102000001-103000000" "103000001-104000000" "104000001-105000000" "105000001-106000000" "106000001-107000000" "107000001-108000000" "108000001-109000000" "109000001-110000000" "110000001-111000000" "111000001-112000000" "112000001-113000000" "113000001-114000000" "114000001-115000000" "115000001-116000000" "116000001-117000000" "117000001-118000000" "118000001-119000000" "119000001-120000000" "120000001-121000000" "121000001-122000000" "122000001-123000000" "123000001-124000000" "124000001-125000000" "125000001-126000000" "126000001-127000000" "127000001-128000000" "129000001-130000000" "130000001-131000000" "131000001-132000000" "132000001-133000000" "133000001-134000000" "134000001-135000000" "135000001-136000000" "136000001-137000000" "137000001-138000000" "138000001-139000000" "139000001-140000000" "140000001-141000000" "141000001-142000000" "142000001-143000000" "143000001-144000000" "144000001-145000000" "145000001-146000000" "146000001-147000000" "147000001-148000000" "148000001-149000000" "149000001-150000000" "150000001-151000000" "151000001-152000000" "152000001-153000000" "153000001-154000000" "154000001-155000000" "155000001-156000000" "156000001-157000000" "157000001-158000000" "158000001-159000000" "159000001-160000000" "160000001-161000000" "161000001-162000000" "162000001-163000000" "163000001-164000000" "164000001-165000000" "165000001-166000000" "166000001-167000000" "167000001-168000000" "168000001-169000000" "169000001-170000000" "170000001-171000000" "171000001-172000000" "172000001-173000000" "173000001-174000000" "174000001-175000000" "175000001-176000000" "176000001-177000000" "177000001-178000000" "179000001-180000000" "180000001-181000000" "181000001-182000000" "182000001-183000000" "183000001-184000000" "184000001-185000000" "185000001-186000000" "186000001-187000000" "187000001-188000000" "188000001-189000000" "189000001-190000000" "190000001-191000000" "191000001-192000000" "192000001-193000000" "193000001-194000000" "194000001-195000000" "195000001-196000000" "196000001-197000000" "197000001-198000000" "198000001-199000000" "199000001-200000000" "200000001-201000000" "201000001-202000000" "202000001-203000000" "203000001-204000000" "204000001-205000000" "205000001-206000000" "206000001-207000000" "207000001-208000000" "208000001-209000000" "209000001-210000000" "210000001-211000000" "211000001-212000000" "212000001-213000000" "213000001-214000000" "214000001-215000000" "215000001-216000000" "216000001-217000000" "217000001-218000000" "218000001-219000000" "219000001-220000000" "220000001-221000000" "221000001-222000000" "222000001-223000000" "223000001-224000000" "224000001-225000000" "225000001-226000000" "226000001-227000000" "227000001-228000000" "228000001-229000000" "229000001-230000000" "230000001-231000000" "231000001-232000000" "232000001-233000000" "233000001-234000000" "234000001-235000000" "235000001-236000000" "236000001-237000000" "237000001-238000000" "238000001-239000000" "240000001-241000000" "241000001-242193529")


for region in ${regions[@]}; do

    job_file="/nobackup1/yraghav/Joint_Genotyping/chr2/scripts/$region.sh"

    echo "#!/bin/bash
#SBATCH --output=/nobackup1/yraghav/Joint_Genotyping/chr2/output/${region}.txt
#SBATCH --error=/nobackup1/yraghav/Joint_Genotyping/chr2/error/${region}.txt
#SBATCH --mem=30GB
#SBATCH --constraint=centos7
#SBATCH --partition=sched_mit_hill
#SBATCH -N 1
#SBATCH -n 16

GVCFS=\`find /nfs/fraenkellab001/Joint_Genotyping/chr2/ -iname \"*haplotypeCalls.er.raw.vcf.gz.tbi\" | perl -pe \"s/\.tbi//g; s/\n/ /g; s/^\//-v  \//g\"\`
export SENTIEON_LICENSE=\"answer.csbi.mit.edu:8990\"

/home/software/fraenkel/sentieon-genomics/bin/sentieon driver -t 16 --traverse_param 10000/200 --shard chr2:$region -r /nobackup1/yraghav/GRCh38_full_analysis_set_plus_decoy_hla.fa --algo GVCFtyper \$GVCFS /nobackup1/yraghav/Joint_Genotyping/chr2/output_vcf/chr2_$region.vcf.gz

" > $job_file
sbatch $job_file

done